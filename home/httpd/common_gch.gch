<%function setpara_value(handle,para_name,value){set_para(handle,para_name,value);}function setpara(handle,para_name){set_para(handle,para_name,request(para_name));}function set_multiinst_para(handle, para_name,index){set_para(handle,para_name,request(para_name+index));}function create_form_start(ID,URL){="<FORM NAME="+ID+" ID="+ID+" METHOD='POST' action="+URL+">\n";}function create_form_end(){="</FORM>\n";}function create_hidden_sep(ID,value){="<INPUT type='hidden' name="+ID+"     ID="+ID+" value=''>\n";="<script language=javascript>Transfer_meaning('";=ID;="','";=value;="');";="</script>\n";}function set_hidden(ID,value){="<script language=javascript>Transfer_meaning('";=ID;="','";=value;="');";="</script>\n";}function create_hidden_newpara(PARA[], num){for(var i=0;i<num;i++){="<INPUT type='hidden' name="+PARA[i]+"   ID="+PARA[i]+" value=''>\n";="<script language=javascript>Transfer_meaning('";=PARA[i];="','";="');";="</script>\n";}}function cover_hidden(handle,PARA[],num){for(var i=0;i<num;i++){="<script language=javascript>Transfer_meaning('";=PARA[i];="','";=get_para(handle,PARA[i]);="');";="</script>\n";}}function create_hidden_para(handle,PARA[],num){for(var i=0;i<num;i++){="<INPUT type='hidden' name="+PARA[i]+"   ID="+PARA[i]+" value=''>\n";="<script language=javascript>Transfer_meaning('";=PARA[i];="','";=get_para(handle,PARA[i]);="');";="</script>\n";}}function create_hidden_multiinstnewpara(handle, PARA[],instindex, num){for(var i=0;i<num;i++){="<INPUT type='hidden' name="+PARA[i]+instindex +"   ID="+PARA[i]+instindex +" value=''>\n";}}function create_hidden_multiinstpara(handle, PARA[],instindex, num){for(var i=0;i<num;i++){="<INPUT type='hidden' name="+PARA[i]+instindex +"   ID="+PARA[i]+instindex +" value=''>\n";="<script language=javascript>Transfer_meaning('";=PARA[i]+instindex;="','";=get_para(handle,PARA[i]);="');";="</script>\n";}}function create_hidden_multiinstpara1(handle, PARA[],instindex, num){for(var i=0;i<num;i++){="<INPUT type='hidden' name="+PARA[i]+instindex +"   ID="+PARA[i]+instindex +" value=''>\n";="<script language=javascript>Transfer_meaning('";=PARA[i]+instindex;="','";=get_para(handle,PARA[i]+instindex);="');";="</script>\n";}}function set_hidden_multiinstpara(handle, PARA[],instindex, num){for(var i=0;i<num;i++){="<script language=javascript>Transfer_meaning('";=PARA[i]+instindex;="','";=get_para(handle,PARA[i]);="');";="</script>\n";}}function create_special_hidden_multiinstpara(handle, inputName, handleName,instindex){="<INPUT type='hidden' name="+inputName +instindex +"   ID="+inputName +instindex +" value=''>\n";="<script language=javascript>Transfer_meaning('";=inputName +instindex;="','";=get_para(handle,handleName);="');";="</script>\n";}function ifIndexNULL(flag,FP_INDEX){if(FP_INDEX IS NULL){if("new"==flag){return -1;}else if("old"==flag){return 0;}}return FP_INDEX;}function getInstIndex(flag){var FP_INDEX=request("IF_INDEX");FP_INDEX=ifIndexNULL(flag,FP_INDEX);return FP_INDEX;}function getInstNum(FP_OBJNAME){return query_list(FP_OBJNAME,"IGD");}function getInstIdentity(FP_OBJNAME,FP_INDEX){var FP_IDENTITY="";var FP_INSTNUM=query_list(FP_OBJNAME,"IGD");if(FP_INSTNUM!=888&&FP_INSTNUM>0&&FP_INDEX>=0){FP_IDENTITY=query_identity(FP_INDEX);}return FP_IDENTITY;}function getMultiInstIdentity(FP_OBJNAME,FP_MULTIDISPLAY,FP_INDEX){var FP_IDENTITY="";if(1==FP_MULTIDISPLAY){FP_IDENTITY=getInstIdentity(FP_OBJNAME,FP_INDEX);}return FP_IDENTITY;}function getInstNumByAction(FP_OBJNAME,FP_MULTIDISPLAY,FP_ACTION){if(1==FP_MULTIDISPLAY&&(FP_ACTION=="apply"||FP_ACTION=="delete")){return query_list(FP_OBJNAME,"IGD");}else {return "";}}function getInstIdentityByAction(FP_OBJNAME,FP_MULTIDISPLAY,FP_ACTION,FP_INDEX){var FP_IDENTITY="";if("new"!=FP_ACTION){FP_IDENTITY=getMultiInstIdentity(FP_OBJNAME,FP_MULTIDISPLAY,FP_INDEX);}return FP_IDENTITY;}function createBasicHidden(){create_hidden_sep("IF_ACTION","");create_hidden_sep("IF_ERRORSTR","SUCC");create_hidden_sep("IF_ERRORPARAM","SUCC");create_hidden_sep("IF_ERRORTYPE",-1);}function createSingleInstHidden(PARA, FP_PARANUM){create_hidden_newpara(PARA, FP_PARANUM);createBasicHidden();}function createHigherHidden(FP_INDEX){createBasicHidden();create_hidden_sep("IF_INDEX",FP_INDEX);create_hidden_sep("IF_INSTNUM","");}function createMultiInstHidden(PARA,FP_PARANUM,FP_INDEX){create_hidden_newpara(PARA, FP_PARANUM);createHigherHidden(FP_INDEX);}function createSubmitHidden(FP_MULTIDISPLAY,PARA,FP_PARANUM,FP_INDEX){if(0==FP_MULTIDISPLAY){createSingleInstHidden(PARA, FP_PARANUM);}else if(1==FP_MULTIDISPLAY){createMultiInstHidden(PARA,FP_PARANUM,FP_INDEX);}}function getNewInstError(FP_ERRORSTR){var FP_ERRORPARAM,FP_ERRORTYPE;if(FP_ERRORSTR=="SUCC"){FP_ERRORSTR=get_cmret();if(FP_ERRORSTR!="SUCC"){if(FP_ERRORSTR!="FAIL"){var cmret="cmret_"+FP_ERRORSTR;FP_ERRORSTR=load_string(cmret);}FP_ERRORPARAM=get_errorparam();FP_ERRORTYPE=get_cmret_type();set_hidden("IF_ERRORSTR",FP_ERRORSTR);set_hidden("IF_ERRORPARAM",FP_ERRORPARAM);set_hidden("IF_ERRORTYPE",FP_ERRORTYPE);}}return FP_ERRORSTR;}function setInst(FP_OBJNAME,FP_IDENTITY,FP_HANDLE){FP_IDENTITY=set_inst(FP_HANDLE, FP_OBJNAME,FP_IDENTITY);return FP_IDENTITY;}function applyOrNewInst(FP_OBJNAME,FP_ACTION,FP_IDENTITY,PARA,FP_PARANUM,FP_ERRORSTR){if("apply"==FP_ACTION||"new"==FP_ACTION){var FP_HANDLE=create_paralist();for(var i=0;i<FP_PARANUM;i++){var value=request(PARA[i]);setpara_value(FP_HANDLE,PARA[i],value);}setInst(FP_OBJNAME,FP_IDENTITY,FP_HANDLE);}return getNewInstError(FP_ERRORSTR);}function applyOrNewOrDelInst(FP_OBJNAME,FP_ACTION,FP_IDENTITY,PARA,FP_PARANUM,FP_ERRORSTR){if("apply"==FP_ACTION||"new"==FP_ACTION){FP_ERRORSTR=applyOrNewInst(FP_OBJNAME,FP_ACTION,FP_IDENTITY,PARA,FP_PARANUM,FP_ERRORSTR);}else if("delete"==FP_ACTION&&""!=FP_IDENTITY){del_inst(FP_OBJNAME, FP_IDENTITY);FP_ERRORSTR=getNewInstError(FP_ERRORSTR);}return FP_ERRORSTR;}function displayOldSingleInst(FP_OBJNAME, FP_IDENTITY,PARA,FP_PARANUM,FP_ERRORSTR){var FP_HANDLE=create_paralist();get_inst(FP_HANDLE, FP_OBJNAME,FP_IDENTITY);cover_hidden(FP_HANDLE,PARA,FP_PARANUM);destroy_paralist(FP_HANDLE);return getDisplayInstError(FP_ERRORSTR);}function displaySingleInst(FP_OBJNAME, PARA,FP_PARANUM){var FP_HANDLE=create_paralist();get_inst(FP_HANDLE, FP_OBJNAME,"");cover_hidden(FP_HANDLE,PARA,FP_PARANUM);destroy_paralist(FP_HANDLE);}function displayInstByNum(FP_OBJNAME,FP_INSTNUM,PARA,FP_PARANUM){var FP_IDENTITY="";for(var i=0;i<FP_INSTNUM;i++){var FP_HANDLE=create_paralist();FP_IDENTITY=query_identity(i);get_inst(FP_HANDLE, FP_OBJNAME,FP_IDENTITY);create_hidden_multiinstpara(FP_HANDLE, PARA,i,FP_PARANUM);destroy_paralist(FP_HANDLE);}}function displayMultiInst(FP_OBJNAME,PARA,FP_PARANUM){var FP_INSTNUM=query_list(FP_OBJNAME,"IGD");displayInstByNum(FP_OBJNAME,FP_INSTNUM,PARA,FP_PARANUM);return FP_INSTNUM;}function displayFunctionInst(FP_OBJNAME,FP_MULTIDISPLAY,PARA,FP_PARANUM,FP_ERRORSTR){if(FP_MULTIDISPLAY==0){displaySingleInst(FP_OBJNAME, PARA,FP_PARANUM);}else if(FP_MULTIDISPLAY==1){displayMultiInst(FP_OBJNAME,PARA,FP_PARANUM);}return getDisplayInstError(FP_ERRORSTR);}function displayInst(FP_OBJNAME,FP_MULTIDISPLAY,PARA,FP_PARANUM,FP_ERRORSTR){var FP_INSTNUM=0;if(FP_MULTIDISPLAY==0){displaySingleInst(FP_OBJNAME, PARA,FP_PARANUM);}else if(FP_MULTIDISPLAY==1){FP_INSTNUM=displayMultiInst(FP_OBJNAME,PARA,FP_PARANUM);}getDisplayInstError(FP_ERRORSTR);return FP_INSTNUM;}function displayInstByAction(FP_OBJNAME,FP_MULTIDISPLAY,FP_INSTNUM,FP_ACTION,PARA,FP_PARANUM){var FP_IDENTITY="";if(FP_MULTIDISPLAY==0){displaySingleInst(FP_OBJNAME, PARA,FP_PARANUM);}else if(FP_MULTIDISPLAY==1){if("delete"==FP_ACTION||"new"==FP_ACTION){FP_INSTNUM=query_list(FP_OBJNAME,"IGD");}displayInstByNum(FP_OBJNAME,FP_INSTNUM,PARA,FP_PARANUM);}return FP_INSTNUM;}function getDisplayInstError(FP_ERRORSTR){var FP_ERRORPARAM,FP_ERRORTYPE;if("SUCC"==FP_ERRORSTR){FP_ERRORSTR=get_cmret();if(FP_ERRORSTR!="FAIL"&&FP_ERRORSTR!="SUCC"){var cmret="cmret_"+FP_ERRORSTR;FP_ERRORSTR=load_string(cmret);}FP_ERRORPARAM=get_errorparam();FP_ERRORTYPE=get_cmret_type();set_hidden("IF_ERRORSTR",FP_ERRORSTR);set_hidden("IF_ERRORPARAM",FP_ERRORPARAM);set_hidden("IF_ERRORTYPE",FP_ERRORTYPE);}return FP_ERRORSTR;}function setInstNumHidden(FP_OBJNAME,FP_MULTIDISPLAY){if(FP_MULTIDISPLAY==1){set_hidden("IF_INSTNUM",getInstNum(FP_OBJNAME));}}function getBasicGCH(FP_OBJNAME,FP_MULTIDISPLAY,PARA,FP_PARANUM,FP_ACTION,FP_INDEX,FP_ERRORSTR){var FP_INSTNUM=0;var FP_IDENTITY="";if(1==FP_MULTIDISPLAY&&(FP_ACTION=="apply"||FP_ACTION=="delete")){FP_INSTNUM=query_list(FP_OBJNAME,"IGD");if(FP_INSTNUM!=888&&FP_INSTNUM>0&&FP_INDEX>=0){FP_IDENTITY=query_identity(FP_INDEX);}}FP_ERRORSTR=applyOrNewOrDelInst(FP_OBJNAME,FP_ACTION,FP_IDENTITY,PARA,FP_PARANUM,FP_ERRORSTR);if("SUCC"!=FP_ERRORSTR){FP_INDEX=-1;FP_IDENTITY="";}FP_INSTNUM=displayInst(FP_OBJNAME,FP_MULTIDISPLAY,PARA,FP_PARANUM,FP_ERRORSTR);getDisplayInstError(FP_ERRORSTR);return FP_ERRORSTR;}function getSubmitGCH(FP_OBJNAME,FP_MULTIDISPLAY,PARA,FP_PARANUM){var FP_ACTION=request("IF_ACTION");var FP_INDEX=getInstIndex("new");var FP_ERRORSTR="SUCC";createSubmitHidden(FP_MULTIDISPLAY,PARA,FP_PARANUM,FP_INDEX);getBasicGCH(FP_OBJNAME,FP_MULTIDISPLAY,PARA,FP_PARANUM,FP_ACTION,FP_INDEX,FP_ERRORSTR);setInstNumHidden(FP_OBJNAME,FP_MULTIDISPLAY);}function getFunctionGCH(FP_OBJNAME,FP_MULTIDISPLAY,PARA,FP_PARANUM,FP_ACTION,FP_INDEX,FP_ERRORSTR){create_hidden_newpara(PARA, FP_PARANUM);FP_ERRORSTR=getBasicGCH(FP_OBJNAME,FP_MULTIDISPLAY,PARA,FP_PARANUM,FP_ACTION,FP_INDEX,FP_ERRORSTR);return FP_ERRORSTR;}function getPageGCH(FP_OBJNAME,FP_MULTIDISPLAY,PARA,FP_PARANUM){create_form_start("fSubmit","");getSubmitGCH(FP_OBJNAME,FP_MULTIDISPLAY,PARA,FP_PARANUM);create_form_end();}function getOldPageGCH(FP_OBJNAME,FP_MULTIDISPLAY,PARA,FP_PARANUM){var FP_ACTION=request("IF_ACTION");var FP_INDEX=getInstIndex("old");var FP_IDENTITY=getInstIdentity(FP_OBJNAME,FP_INDEX);var FP_ERRORSTR="SUCC";create_form_start("fSubmit","");createSubmitHidden(FP_MULTIDISPLAY,PARA,FP_PARANUM,FP_INDEX);FP_ERRORSTR=applyOrNewOrDelInst(FP_OBJNAME,FP_ACTION,FP_IDENTITY,PARA,FP_PARANUM,FP_ERRORSTR);FP_ERRORSTR=displayOldSingleInst(FP_OBJNAME, FP_IDENTITY,PARA,FP_PARANUM,FP_ERRORSTR);create_form_end();}function getOldFunctionGCH(FP_OBJNAME,FP_MULTIDISPLAY,PARA,FP_PARANUM,FP_ACTION,FP_INDEX,FP_ERRORSTR){var FP_IDENTITY=getInstIdentity(FP_OBJNAME,FP_INDEX);create_hidden_newpara(PARA, FP_PARANUM);FP_ERRORSTR=applyOrNewOrDelInst(FP_OBJNAME,FP_ACTION,FP_IDENTITY,PARA,FP_PARANUM,FP_ERRORSTR);FP_ERRORSTR=displayOldSingleInst(FP_OBJNAME, FP_IDENTITY,PARA,FP_PARANUM,FP_ERRORSTR);return FP_ERRORSTR;}function getBasicGCH_IGD(FP_OBJNAME,FP_MULTIDISPLAY,PARA,FP_PARANUM,FP_ACTION,FP_INDEX,FP_ERRORSTR,IGD_IDN){var FP_INSTNUM=0;var FP_IDENTITY="";if(1==FP_MULTIDISPLAY&&(FP_ACTION=="apply"||FP_ACTION=="delete")){FP_INSTNUM=query_list(FP_OBJNAME,IGD_IDN);if(FP_INSTNUM!=888&&FP_INSTNUM>0&&FP_INDEX>=0){FP_IDENTITY=query_identity(FP_INDEX);}}if(FP_IDENTITY==""){FP_ERRORSTR=applyOrNewOrDelInst(FP_OBJNAME,FP_ACTION,FP_IDENTITY,PARA,FP_PARANUM,FP_ERRORSTR);}else {var len_ide=strlen(FP_IDENTITY);var NP_ID;if(len_ide==21){NP_ID=substr(FP_IDENTITY,len_ide-1,len_ide);}else {NP_ID=substr(FP_IDENTITY,len_ide-2,len_ide);}for(var i=1;i<5;i++){FP_IDENTITY="IGD.SV.VS1.VP"+i+".VN.NP"+NP_ID;FP_ERRORSTR=applyOrNewOrDelInst(FP_OBJNAME,FP_ACTION,FP_IDENTITY,PARA,FP_PARANUM,FP_ERRORSTR);}}if("SUCC"!=FP_ERRORSTR){FP_INDEX=-1;FP_IDENTITY="";}FP_INSTNUM=displayInst_IGD(FP_OBJNAME,FP_MULTIDISPLAY,PARA,FP_PARANUM,FP_ERRORSTR,IGD_IDN);getDisplayInstError(FP_ERRORSTR);return FP_ERRORSTR;}function displayInst_IGD(FP_OBJNAME,FP_MULTIDISPLAY,PARA,FP_PARANUM,FP_ERRORSTR,IGD_IDN){var FP_INSTNUM=0;if(FP_MULTIDISPLAY==0){displaySingleInst(FP_OBJNAME, PARA,FP_PARANUM);}else if(FP_MULTIDISPLAY==1){FP_INSTNUM=displayMultiInst_IGD(FP_OBJNAME,PARA,FP_PARANUM,IGD_IDN);}getDisplayInstError(FP_ERRORSTR);return FP_INSTNUM;}function displayMultiInst_IGD(FP_OBJNAME,PARA,FP_PARANUM,IGD_IDN){var FP_INSTNUM=query_list(FP_OBJNAME,IGD_IDN);displayInstByNum(FP_OBJNAME,FP_INSTNUM,PARA,FP_PARANUM);return FP_INSTNUM;}function getFunctionGCH_Filter(FP_OBJNAME,FP_MULTIDISPLAY,PARA,FP_PARANUM,FP_ACTION,FP_INDEX,FP_ERRORSTR,Filter_PARA,Filter_PARANUM){create_hidden_newpara(PARA, FP_PARANUM);FP_ERRORSTR=getBasicGCH_Filter(FP_OBJNAME,FP_MULTIDISPLAY,PARA,FP_PARANUM,FP_ACTION,FP_INDEX,FP_ERRORSTR,Filter_PARA,Filter_PARANUM);return FP_ERRORSTR;}function getBasicGCH_Filter(FP_OBJNAME,FP_MULTIDISPLAY,PARA,FP_PARANUM,FP_ACTION,FP_INDEX,FP_ERRORSTR,Filter_PARA,Filter_PARANUM){var FP_INSTNUM=0;var FP_IDENTITY="";if(1==FP_MULTIDISPLAY&&(FP_ACTION=="apply"||FP_ACTION=="delete")){FP_INSTNUM=query_list(FP_OBJNAME,"IGD");if(FP_INSTNUM!=888&&FP_INSTNUM>0&&FP_INDEX>=0){FP_IDENTITY=query_identity(FP_INDEX);}}FP_ERRORSTR=applyOrNewOrDelInst_Filter(FP_OBJNAME,FP_ACTION,FP_IDENTITY,PARA,FP_PARANUM,FP_ERRORSTR,Filter_PARA,Filter_PARANUM);if("SUCC"!=FP_ERRORSTR){FP_INDEX=-1;FP_IDENTITY="";}FP_INSTNUM=displayInst(FP_OBJNAME,FP_MULTIDISPLAY,PARA,FP_PARANUM,FP_ERRORSTR);getDisplayInstError(FP_ERRORSTR);return FP_ERRORSTR;}function applyOrNewOrDelInst_Filter(FP_OBJNAME,FP_ACTION,FP_IDENTITY,PARA,FP_PARANUM,FP_ERRORSTR,Filter_PARA,Filter_PARANUM){if("apply"==FP_ACTION||"new"==FP_ACTION){FP_ERRORSTR=applyOrNewInst_Filter(FP_OBJNAME,FP_ACTION,FP_IDENTITY,PARA,FP_PARANUM,FP_ERRORSTR,Filter_PARA,Filter_PARANUM);}else if("delete"==FP_ACTION&&""!=FP_IDENTITY){del_inst(FP_OBJNAME, FP_IDENTITY);FP_ERRORSTR=getNewInstError(FP_ERRORSTR);}return FP_ERRORSTR;}function applyOrNewInst_Filter(FP_OBJNAME,FP_ACTION,FP_IDENTITY,PARA,FP_PARANUM,FP_ERRORSTR,Filter_PARA,Filter_PARANUM){if("apply"==FP_ACTION||"new"==FP_ACTION){var FP_HANDLE=create_paralist();for(var i=0;i<FP_PARANUM;i++){var value="NULL";for(var j=0;j<Filter_PARANUM;j++){if(PARA[i]==Filter_PARA[j])value=request(PARA[i]);}setpara_value(FP_HANDLE,PARA[i],value);}setInst(FP_OBJNAME,FP_IDENTITY,FP_HANDLE);}return getNewInstError(FP_ERRORSTR);}function getPageGCH_Filter(FP_OBJNAME,FP_MULTIDISPLAY,PARA,FP_PARANUM,Filter_PARA,Filter_PARANUM){create_form_start("fSubmit","");getSubmitGCH_Filter(FP_OBJNAME,FP_MULTIDISPLAY,PARA,FP_PARANUM,Filter_PARA,Filter_PARANUM);create_form_end();}function getSubmitGCH_Filter(FP_OBJNAME,FP_MULTIDISPLAY,PARA,FP_PARANUM,Filter_PARA,Filter_PARANUM){var FP_ACTION=request("IF_ACTION");var FP_INDEX=getInstIndex("new");var FP_ERRORSTR="SUCC";createSubmitHidden(FP_MULTIDISPLAY,PARA,FP_PARANUM,FP_INDEX);getBasicGCH_Filter(FP_OBJNAME,FP_MULTIDISPLAY,PARA,FP_PARANUM,FP_ACTION,FP_INDEX,FP_ERRORSTR,Filter_PARA,Filter_PARANUM);setInstNumHidden(FP_OBJNAME,FP_MULTIDISPLAY);}function Escapquotes(para){var paralen=strlen(para);var part="";var tmp="";for(var i=0;i<paralen;i++){part=substr(para,i,i+1);if('"' == part)
tmp = tmp + '\"';else tmp=tmp+part;}return tmp;}%>